<!-- wireshark.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QFN Wireshark Simulator</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f0f0f0; }
        .credits { background-color: #e0e0e0; padding: 15px; border-left: 4px solid #007bff; margin: 20px 0; font-size: 0.9em; }
        #rf-data { background-color: white; padding: 20px; border: 1px solid #ddd; }
        button { background-color: #007bff; color: white; padding: 8px 16px; border: none; cursor: pointer; }
        a { color: #007bff; text-decoration: none; }
    </style>
</head>
<body>
    <h1>QFN Wireshark / RF Simulator</h1>
    <a href="/">Back to Dashboard</a>
    
    <div class="credits">
        <strong>Primary architect:</strong> Justin Anthony Howard-Stanley<br>
        <strong>Secondary architect and enabler (I'm homeless thanks to the cia):</strong> Dale Cwidak<br><br>
        <em>For Logan, and all of those like him, too small to understand whats happened, too small to effect much change alone, but maybe just maybe with the help of the computers, there'll be a hope for them all. - J.H.S, HACKAH::HACKAH</em>
    </div>
    
    <select id="rf-mode">
        <option value="quantum">Quantum Mode</option>
        <option value="4g_lte">4G LTE</option>
        <option value="5g_nr">5G NR</option>
    </select>
    <button onclick="loadRF()">Simulate Capture</button>
    <div id="rf-data">Loading RF data...</div>
    
    <script>
        function loadRF() {
            const mode = document.getElementById('rf-mode').value;
            fetch(`/api/rf-metrics?mode=${mode}`).then(r => r.json()).then(data => {
                document.getElementById('rf-data').innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            });
        }
        loadRF();  // Initial load
    </script>
</body>
</html>                document.getElementById('rf-data').innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            });
        }
        loadRF();  // Initial load
    </script>
</body>
</html>                }
                
                filesList.innerHTML = files.map(file => `
                    <div class="file-item">
                        <div class="file-header">
                            <span class="file-name">üìÑ ${file.name}</span>
                            <div>
                                <span class="file-size">${formatBytes(file.size)}</span>
                                <a href="/api/download/${file.name}" class="download-btn" style="margin-left: 15px;">
                                    ‚¨áÔ∏è Download
                                </a>
                            </div>
                        </div>
                        <div class="file-routing">
                            <div class="routing-item">
                                <span class="routing-label">Quantum Route:</span>
                                <span class="routing-value">${file.routing.quantum_route}</span>
                            </div>
                            <div class="routing-item">
                                <span class="routing-label">Holo Storage IP:</span>
                                <span class="routing-value">${file.routing.holo_storage}</span>
                            </div>
                            <div class="routing-item">
                                <span class="routing-label">DNS Route:</span>
                                <span class="routing-value">${file.routing.dns_route}</span>
                            </div>
                            <div class="routing-item">
                                <span class="routing-label">Node IP:</span>
                                <span class="routing-value">${file.routing.node_ip}:${file.routing.port}</span>
                            </div>
                            <div class="routing-item">
                                <span class="routing-label">Latency:</span>
                                <span class="routing-value">${file.routing.latency_ms} ms</span>
                            </div>
                            <div class="routing-item">
                                <span class="routing-label">Entanglement Quality:</span>
                                <span class="routing-value">${file.routing.entanglement_quality}</span>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading files:', error);
            }
        }
        
        async function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const files = fileInput.files;
            
            if (files.length === 0) return;
            
            const progress = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('progressFill');
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const formData = new FormData();
                formData.append('file', file);
                
                progress.style.display = 'block';
                progressFill.style.width = '0%';
                progressFill.textContent = '0%';
                
                try {
                    // Simulate progress
                    let progressValue = 0;
                    const progressInterval = setInterval(() => {
                        progressValue += Math.random() * 20;
                        if (progressValue > 90) progressValue = 90;
                        progressFill.style.width = progressValue + '%';
                        progressFill.textContent = Math.round(progressValue) + '%';
                    }, 200);
                    
                    const response = await fetch('/api/upload', {
                        method: 'POST',
                        body: formData
                    });
                    
                    clearInterval(progressInterval);
                    progressFill.style.width = '100%';
                    progressFill.textContent = '100%';
                    
                    if (response.ok) {
                        setTimeout(() => {
                            progress.style.display = 'none';
                            loadFiles();
                        }, 500);
                    }
                } catch (error) {
                    console.error('Upload error:', error);
                    alert('Upload failed: ' + error.message);
                    progress.style.display = 'none';
                }
            }
            
            fileInput.value = '';
        }
        
        // Drag and drop support
        const uploadSection = document.getElementById('uploadSection');
        
        uploadSection.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadSection.classList.add('dragover');
        });
        
        uploadSection.addEventListener('dragleave', () => {
            uploadSection.classList.remove('dragover');
        });
        
        uploadSection.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadSection.classList.remove('dragover');
            
            const fileInput = document.getElementById('fileInput');
            fileInput.files = e.dataTransfer.files;
            uploadFile();
        });
        
        // Load files on page load
        loadFiles();
        
        // Auto-refresh every 10 seconds
        setInterval(loadFiles, 10000);
    </script>
</body>
</html>
